<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tools for Working with CORINE Land Cover Data and Styles • clc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tools for Working with CORINE Land Cover Data and Styles">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/clc.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/josesamos/clc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tools for Working with CORINE Land Cover Data and Styles</h1>
                        <h4 data-toc-skip class="author">Jose Samos (<a href="mailto:jsamos@ugr.es" class="email">jsamos@ugr.es</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/josesamos/clc/blob/main/vignettes/clc.Rmd" class="external-link"><code>vignettes/clc.Rmd</code></a></small>
      <div class="d-none name"><code>clc.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This section introduces <em>CORINE Land Cover</em>. It also presents
the <code>clc</code> package, highlighting its functionalities. Finally,
the document’s structure is outlined.</p>
<div class="section level3">
<h3 id="corine-land-cover">
<em>CORINE Land Cover</em><a class="anchor" aria-label="anchor" href="#corine-land-cover"></a>
</h3>
<p><em>CORINE Land Cover (CLC)</em> is a standardized geospatial dataset
that provides detailed land cover and land use information across
Europe. Established under the European Commission’s <em>CORINE</em>
(<em>Coordination of Information on the Environment</em>) program, CLC
offers consistent and comparable land cover data for environmental
monitoring and spatial planning.</p>
<p>CLC aligns with the <em>INSPIRE Directive</em> (<em>Infrastructure
for Spatial Information in the European Community</em>), which
establishes a framework for spatial data interoperability across Europe.
CLC datasets conform to INSPIRE’s standards for land cover data,
ensuring compatibility with other datasets and supporting European
environmental and planning initiatives.</p>
<p>CLC is available in both vector and raster formats:</p>
<ul>
<li><p>Vector Format: Represents land cover polygons, each categorized
using predefined CLC codes. This format typically includes an associated
style definition (e.g., QML or SLD) that ensures consistent
visualization of land cover classes across platforms.</p></li>
<li><p>Raster Format: Provides land cover data in a gridded format with
cell values corresponding to CLC codes.</p></li>
</ul>
<p>Each CLC <em>code</em> is associated with a specific <em>color</em>
and <em>description</em> as part of its classification system. Style
files (e.g., QGIS QML or SLD files) are often included with CLC
datasets, enabling standardized visualization of land cover classes for
accurate and intuitive map representation. In GeoPackage and PostGIS
formats, styles are stored in a dedicated table, which contains metadata
associated with each layer.</p>
</div>
<div class="section level3">
<h3 id="the-clc-package">The <code>clc</code> package<a class="anchor" aria-label="anchor" href="#the-clc-package"></a>
</h3>
<p>The goal of the <code>clc</code> package is to support operations
with CLC data, addressing the challenges and specificities it presents,
particularly those related to its associated styles. Its main
characteristics are the following:</p>
<ol style="list-style-type: decimal">
<li><p>It automates the extraction, application, and preservation of
styles across workflows.</p></li>
<li><p>Tasks such as reading CLC vector data, applying styles, clipping
layers, and converting vector data to raster format involve multiple
steps. The <code>clc</code> package provides simplified, high-level
functions to handle these tasks efficiently.</p></li>
<li><p>It handles CLC data in both GeoPackage and PostGIS formats,
supporting them as sources and destinations.</p></li>
</ol>
<p>The <code>clc</code> package includes the <code>clc</code> class,
designed as a comprehensive toolkit for managing and processing CLC
data, enabling users to perform a wide range of geospatial operations
efficiently.</p>
</div>
<div class="section level3">
<h3 id="document-structure">Document Structure<a class="anchor" aria-label="anchor" href="#document-structure"></a>
</h3>
<p>Apart from this introduction, the document begins by presenting the
data available within the package. It then demonstrates the
functionalities of the <code>clc</code> class through a complete usage
example. Finally, it concludes with a summary of the functionalities and
their benefits.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-included-in-the-package">Data Included in the Package<a class="anchor" aria-label="anchor" href="#data-included-in-the-package"></a>
</h2>
<p>The package includes the following datasets to support workflows with
CLC data:</p>
<ul>
<li>
<code>clc.gpkg</code>, a GeoPackage file containing the following
vector layers:
<ul>
<li>
<code>clc</code>: A fragment of CLC data for a region in Granada,
Spain, stored in vector format. This layer includes the associated style
definitions, which are stored within the same GeoPackage. The data was
sourced from the <a href="https://www.cnig.es/" class="external-link"><em>CNIG (Centro
Nacional de Información Geográfica)</em></a>.<br>
</li>
<li>
<code>lanjaron</code>: A polygonal vector layer representing the
boundaries of the municipality of Lanjarón, located in Granada, Spain.
This data was sourced from the <a href="https://www.juntadeandalucia.es/institutodeestadisticaycartografia/dega/datos-espaciales-de-referencia-de-andalucia-dera" class="external-link"><em>DERA
(Datos Espaciales de Referencia de Andalucía)</em></a>.</li>
</ul>
</li>
<li>
<code>mdt.tif</code>, a raster file containing a Digital Terrain
Model (DTM) for the same region as the <code>clc</code> and
<code>lanjaron</code> layers. This data was also obtained from the
<em>CNIG</em>. The DTM data is not actually used; only its format is
needed as a template to create a base raster.</li>
</ul>
<p>These datasets provide a foundational base for exploring the
functionalities of the package, including vector and raster data
processing and visualization.</p>
</div>
<div class="section level2">
<h2 id="class-based-operations">Class-Based Operations<a class="anchor" aria-label="anchor" href="#class-based-operations"></a>
</h2>
<p>Key features of the <code>clc</code> class include the ability to
read CLC datasets directly from widely used geospatial databases, such
as GeoPackage or PostGIS.</p>
<p>The class also facilitates advanced visualization of CLC vector data,
complete with associated styles, to accurately represent land cover
classifications. Users can further refine datasets by clipping CLC data
to specific regions of interest while preserving style consistency,
enabling localized analyses.</p>
<p>In addition to vector processing, the <code>clc</code> class supports
the conversion of CLC vector data into raster formats, expanding its
utility for raster-based analyses. Once rasterized, users can visualize
CLC raster data with styles that mirror the original vector
representation, maintaining interpretability.</p>
<p>To support data sharing and further processing, the <code>clc</code>
class includes functionality for exporting both CLC data and their
associated styles back to GeoPackage or PostGIS, ensuring data integrity
and compatibility with external systems.</p>
<p>The following provides a detailed example illustrating the
functionalities described earlier.</p>
<div class="section level3">
<h3 id="create-an-object-of-class-clc">Create an object of class <code>clc</code><a class="anchor" aria-label="anchor" href="#create-an-object-of-class-clc"></a>
</h3>
<p>We start by showing how to create an object of class <code>clc</code>
from a vector layer. The <code>source</code> parameter specifies the
source of the vector data, which can be a path to a GeoPackage file or a
<code>DBI</code> connection to a PostGIS database. The
<code>layer_name</code> parameter is the name of the specific layer in
the source to be used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josesamos.github.io/clc/">clc</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">source_gpkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"clc.gpkg"</span>, package <span class="op">=</span> <span class="st">"clc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clc.html">clc</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">source_gpkg</span>, layer_name <span class="op">=</span> <span class="st">"clc"</span><span class="op">)</span></span></code></pre></div>
<p>To create a <code>clc</code> object, the vector layer must have
associated styles in its source. These styles are essential as they
define the visual appearance of the CLC data, including category colors
and labels.</p>
<p>We can include a parameter called <code>field</code>, which is
optional. It should only be provided if the function is unable to
automatically determine the field containing the CLC codes in the layer.
This can happen if there are multiple fields or none at all. If
<code>field</code> is set to <code>NULL</code> (default), the function
will attempt to locate the appropriate column that contains the CLC
codes based on the layer’s structure.</p>
<p>The function returns an object of class <code>clc</code>, which can
then be used for further analysis and visualization.</p>
<p>In this case, the following code would achieve the same result,
assuming the database contains the same layer and styles stored.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josesamos.github.io/clc/">clc</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu">RPostgres</span><span class="fu">::</span><span class="fu">dbConnect</span><span class="op">(</span></span>
<span>  <span class="fu">RPostgres</span><span class="fu">::</span><span class="fu"><a href="https://rpostgres.r-dbi.org/reference/Postgres.html" class="external-link">Postgres</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="st">'exampledb'</span>,</span>
<span>  host <span class="op">=</span> <span class="st">'localhost'</span>,</span>
<span>  port <span class="op">=</span> <span class="st">'5432'</span>,</span>
<span>  user <span class="op">=</span> <span class="st">'user'</span>,</span>
<span>  password <span class="op">=</span> <span class="st">'password'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">clc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clc.html">clc</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">conn</span>, layer_name <span class="op">=</span> <span class="st">"clc"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span></code></pre></div>
<p>This example demonstrates how to use a PostGIS database connection
instead of a GeoPackage file. However, since the example is designed to
run within the package and without external dependencies like a live
database, we use the local <code>clc.gpkg</code> file instead.</p>
</div>
<div class="section level3">
<h3 id="plot-of-vector-clc-data">Plot of Vector CLC Data<a class="anchor" aria-label="anchor" href="#plot-of-vector-clc-data"></a>
</h3>
<p>Once the object is created with its associated style, the next step
is to visualize the data with the applied style. This is achieved by
using the following function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clc_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/plot_clc.html">plot_clc</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="clc_files/figure-html/example-1-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>This command automatically considers the style that was previously
associated with the <code>clc</code> object. It ensures that the vector
data is displayed with the appropriate colors and descriptions, as
defined in the source, without the need for further styling
adjustments.</p>
<p>The vector plot for CLC data is created using the
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot</a></code> function. This function is defined using
other functions from the <code>ggplot2</code> package to ensure the plot
is displayed with appropriate styling and formatting.</p>
<p>However, instead of directly using <code>plot_clc</code>, the
<code>prepare_plot</code> function is included in the package to define
the basic elements of the plot. This function prepares the necessary
components for visualization, but leaves the final presentation and
customization up to the user.</p>
<p>To complete the plot configuration, the missing elements, such as
color and labels, can be obtained using the <code>get_levels</code>
function. These elements can then be used to define the presentation
according to the user’s preferences. For example, the following code
achieves the same result as <code>plot_clc</code>, but provides more
flexibility for further customization:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">clc_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/prepare_plot.html">prepare_plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">levels</span> <span class="op">&lt;-</span> <span class="va">clc_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_levels.html">get_levels</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">levels</span><span class="op">$</span><span class="va">color</span>, <span class="va">levels</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">levels</span><span class="op">$</span><span class="va">description</span>, <span class="va">levels</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="clc_files/figure-html/example-1-1-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>This code customizes the plot by defining the color scale, adding
labels, and modifying the appearance of the legend. It allows for full
control over how the data is presented, beyond the default configuration
provided by <code>plot_clc</code>.</p>
</div>
<div class="section level3">
<h3 id="clipping-clc-data-to-a-region-of-interest">Clipping CLC Data to a Region of Interest<a class="anchor" aria-label="anchor" href="#clipping-clc-data-to-a-region-of-interest"></a>
</h3>
<p>In this section, we focus on the process of clipping CLC data to a
region of interest, using the provided <code>cut_to_extent</code>
function. This function is an essential tool for isolating specific
areas within the CLC data, allowing users to work with smaller, relevant
subsets of the data.</p>
<p>First, we read the clipping layer (the region of interest) from the
source GeoPackage, which defines the geographical boundaries for the
clip. After loading the region, we use the <code>cut_to_extent</code>
function to clip the CLC data to this region.</p>
<p>Once the data is clipped, it is visualized using the
<code>plot_clc</code> function, which applies the appropriate styling
and provides a clear representation of the clipped CLC data.</p>
<p>Here’s an example of how to clip the CLC data to a region and
visualize the result:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the clipping layer (region of interest)</span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">source_gpkg</span>, layer <span class="op">=</span> <span class="st">"lanjaron"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clip the CLC data to the region of interest</span></span>
<span><span class="va">clc_clipped</span> <span class="op">&lt;-</span> <span class="va">clc_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cut_to_extent.html">cut_to_extent</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the clipped CLC data with its associated style</span></span>
<span><span class="va">clc_clipped</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/plot_clc.html">plot_clc</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="clc_files/figure-html/example-2-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>This workflow demonstrates how the <code>cut_to_extent</code>
function can be used to subset CLC data by a specific region and
visualize the clipped data, all while retaining the correct styling.</p>
</div>
<div class="section level3">
<h3 id="saving-clc-data-and-styles">Saving CLC Data and Styles<a class="anchor" aria-label="anchor" href="#saving-clc-data-and-styles"></a>
</h3>
<p>In this section, we focus on how to save the CLC data, along with its
associated styles, to a GeoPackage. This process ensures that the data
is preserved in a standard format for future use, with the correct
styling embedded in the file.</p>
<p>For example, after clipping the CLC data, you may want to store the
resulting subset along with the style information in a GeoPackage file
(new or existing one). The <code>save_to</code> function is used to
write both the CLC data and its styles to the specified GeoPackage
destination.</p>
<p>The following example demonstrates how to save the clipped CLC data
and its styles to a new GeoPackage:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the output GeoPackage file</span></span>
<span><span class="va">output_gpkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".gpkg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Capture output to suppress messages (optional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sink.html" class="external-link">sink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the clipped data and its styles to the new GeoPackage</span></span>
<span><span class="va">clc_clipped</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/save_to.html">save_to</a></span><span class="op">(</span><span class="va">output_gpkg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stop capturing output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sink.html" class="external-link">sink</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This workflow saves the clipped CLC data to a new GeoPackage file,
ensuring that both the data and its associated styles are properly
stored. You can later access the file, preserving the full context of
the original dataset, including the applied styles.</p>
<p>In addition to saving the clipped data to a GeoPackage, you can also
save it to a PostGIS database. The following example demonstrates it.
However, this example is not executed here to avoid creating external
dependencies on a database connection.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu">RPostgres</span><span class="fu">::</span><span class="fu">dbConnect</span><span class="op">(</span></span>
<span>  <span class="fu">RPostgres</span><span class="fu">::</span><span class="fu"><a href="https://rpostgres.r-dbi.org/reference/Postgres.html" class="external-link">Postgres</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="st">'exampledb2'</span>,</span>
<span>  host <span class="op">=</span> <span class="st">'localhost'</span>,</span>
<span>  port <span class="op">=</span> <span class="st">'5432'</span>,</span>
<span>  user <span class="op">=</span> <span class="st">'user'</span>,</span>
<span>  password <span class="op">=</span> <span class="st">'password'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">clc_clipped</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/save_to.html">save_to</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">'exampledb2'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span></code></pre></div>
<p>The same <code>save_to</code> function can be used with a PostGIS
connection, just like with GeoPackage, enabling flexibility in where the
data is stored.</p>
</div>
<div class="section level3">
<h3 id="copying-styles">Copying Styles<a class="anchor" aria-label="anchor" href="#copying-styles"></a>
</h3>
<p>The <code>copy_to</code> function in the <code>clc</code> package
enables you to copy only the style definitions from one source and apply
them to a specified layer or all layers in the destination. If no
specific layer is indicated, the style is applied to all layers in the
destination.</p>
<p>Below is an example demonstrating how to use
<code>copy_to</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new GeoPackage without style definition</span></span>
<span><span class="va">destination_gpkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".gpkg"</span><span class="op">)</span></span>
<span><span class="va">clc_layer</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">source_gpkg</span>, layer <span class="op">=</span> <span class="st">"clc"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span></span>
<span>  <span class="va">clc_layer</span>,</span>
<span>  <span class="va">destination_gpkg</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"clc2"</span>,</span>
<span>  delete_layer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Copy the style to the new GeoPackage</span></span>
<span><span class="va">clc_clipped</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/copy_to.html">copy_to</a></span><span class="op">(</span>to <span class="op">=</span> <span class="va">destination_gpkg</span>, layers <span class="op">=</span> <span class="st">"clc2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a clc object from the new GeoPackage and view it</span></span>
<span><span class="va">clc_data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clc.html">clc</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">destination_gpkg</span>, layer_name <span class="op">=</span> <span class="st">"clc2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clc_data2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/plot_clc.html">plot_clc</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="clc_files/figure-html/example-4-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>This workflow demonstrates the flexibility of the <code>clc</code>
package in managing styles across multiple GeoPackages. The
<code>copy_to</code> function can also be used with a PostGIS database
as the destination.</p>
</div>
<div class="section level3">
<h3 id="converting-clc-data-to-raster-format">Converting CLC Data to Raster Format<a class="anchor" aria-label="anchor" href="#converting-clc-data-to-raster-format"></a>
</h3>
<p>The <code>as_raster</code> function in the <code>clc</code> package
provides an efficient way to convert vector-based CLC data into a raster
format. This is particularly useful when working with raster-based
analysis workflows</p>
<p>The function allows specifying a base raster for consistent alignment
and resolution with existing raster data. If no base raster is provided,
a custom resolution can be specified to generate the raster grid.</p>
<p>The raster output retains the CLC categories, ensuring that the data
remains consistent with its original classification.</p>
<p>Below are two examples demonstrating the use of
<code>as_raster</code>:</p>
<ul>
<li>If a base raster is available, you can use it to define the extent,
resolution, and coordinate reference system (CRS) for the output
raster.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raster_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mdt.tif"</span>, package <span class="op">=</span> <span class="st">"clc"</span><span class="op">)</span></span>
<span><span class="va">base_raster</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">raster_path</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clc_raster1</span> <span class="op">&lt;-</span> <span class="va">clc_clipped</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_raster.html">as_raster</a></span><span class="op">(</span>base_raster <span class="op">=</span> <span class="va">base_raster</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>When no base raster is available, you can specify a resolution to
define the raster grid.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clc_raster2</span> <span class="op">&lt;-</span> <span class="va">clc_clipped</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_raster.html">as_raster</a></span><span class="op">(</span>resolution <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>These examples demonstrate how <code>as_raster</code> streamlines the
conversion process, making it easier to integrate vector-based CLC data
into raster workflows.</p>
</div>
<div class="section level3">
<h3 id="applications-of-the-generated-raster">Applications of the Generated Raster<a class="anchor" aria-label="anchor" href="#applications-of-the-generated-raster"></a>
</h3>
<p>After converting CLC data to raster format using the
<code>as_raster</code> function, the raster can be used for various
applications. Below, we demonstrate two common use cases.</p>
<p>These examples illustrate the versatility of the raster output,
making it suitable for visualization, sharing, or extended GIS
workflows.</p>
<div class="section level4">
<h4 id="visualizing-the-raster-data">Visualizing the Raster Data<a class="anchor" aria-label="anchor" href="#visualizing-the-raster-data"></a>
</h4>
<p>For raster visualization, the <code><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">terra::plot</a></code> function is
used with the color scheme configured (using the <code>col</code>
parameter) to match the CLC styles. The <code>plot_clc</code> function
allows customization of all other parameters supported by
<code><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">terra::plot</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clc_raster1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/plot_clc.html">plot_clc</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="clc_files/figure-html/example-3-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>This renders the raster using the colors and descriptions associated
with the original CLC styles, ensuring a clear and accurate
representation of the data.</p>
</div>
<div class="section level4">
<h4 id="getting-the-raster">Getting the Raster<a class="anchor" aria-label="anchor" href="#getting-the-raster"></a>
</h4>
<p>The <code>get_raster</code> function extracts a
<code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">terra::SpatRaster</a></code> object for further customization,
analysis, or storage.</p>
<p>Once the raster is obtained, it can be exported to a file format such
as GeoTIFF. This is particularly useful for sharing the data or for
further processing in GIS software.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clc_r</span> <span class="op">&lt;-</span> <span class="va">clc_raster1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_raster.html">get_raster</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_tif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">clc_r</span>,</span>
<span>                   <span class="va">output_tif</span>,</span>
<span>                   filetype <span class="op">=</span> <span class="st">"GTiff"</span>,</span>
<span>                   overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>This workflow creates a GeoTIFF file containing the rasterized CLC
data, making it compatible with most GIS platforms and software.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>The <code>clc</code> package provides an efficient and user-friendly
framework for managing and processing CLC data. By automating key
operations such as style handling, clipping, rasterization, and data
export, it simplifies workflows and enhances interoperability between
geospatial formats like GeoPackage and PostGIS.</p>
<p>Through its flexible and well-documented functionality, the package
addresses the complexities associated with CLC data, ensuring accurate
visualization and seamless integration into GIS workflows. The detailed
examples and workflows presented demonstrate its potential to streamline
CLC data management, making it a valuable tool for environmental
analysis, spatial planning, and research applications.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jose Samos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
